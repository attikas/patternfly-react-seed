import * as React from 'react';
import { NavLink, useLocation } from 'react-router-dom';
import {
  Button,
  Masthead,
  MastheadBrand,
  MastheadLogo,
  MastheadMain,
  MastheadToggle,
  Nav,
  NavExpandable,
  NavItem,
  NavList,
  Page,
  PageSidebar,
  PageSidebarBody,
  SkipToContent,
} from '@patternfly/react-core';
import { IAppRoute, IAppRouteGroup, routes } from '@app/routes';
import { BarsIcon } from '@patternfly/react-icons';
import { KebabDropdownWithIconsV6 } from './KebabMenu';

interface IAppLayout {
  children: React.ReactNode;
}

export const AppLayout: React.FunctionComponent<IAppLayout> = ({ children }) => {
  const [sidebarOpen, setSidebarOpen] = React.useState(true);

  const masthead = (
    <Masthead>
      <MastheadMain>
        <MastheadToggle>
          <Button
            icon={<BarsIcon />}
            variant="plain"
            onClick={() => setSidebarOpen(!sidebarOpen)}
            aria-label="Global navigation"
          />
        </MastheadToggle>
        <MastheadBrand data-codemods>
          <MastheadLogo data-codemods>
            <svg width="100%" height="100%" viewBox="0 0 92.176659 19.222057">
              <title>Attikas Ltd</title>
              <g strokeWidth="1" fill="none" fillRule="evenodd" transform="translate(-35,-94)">
                <g fill="var(--pf-t--global--text--color--regular)">
                  <path d="M 57.844691 97.091266 L 57.844691 98.71959 L 59.868857 98.71959 L 59.868857 97.091266 L 57.844691 97.091266 z M 61.878037 97.258697 L 61.878037 107.8813 L 63.567339 107.8813 L 63.567339 97.258697 L 61.878037 97.258697 z M 46.887221 98.263287 L 46.887221 100.30244 L 45.060976 100.30244 L 45.060976 101.68737 L 46.887221 101.68737 L 46.887221 107.8813 L 48.592026 107.8813 L 48.592026 101.68737 L 50.418271 101.68737 L 50.418271 100.30244 L 48.592026 100.30244 L 48.592026 98.263287 L 46.887221 98.263287 z M 53.035683 98.263287 L 53.035683 100.30244 L 51.209437 100.30244 L 51.209437 101.68737 L 53.035683 101.68737 L 53.035683 107.8813 L 54.740488 107.8813 L 54.740488 101.68737 L 56.566733 101.68737 L 56.566733 100.30244 L 54.740488 100.30244 L 54.740488 98.263287 L 53.035683 98.263287 z M 38.957989 100.13501 C 38.227477 100.13501 37.568283 100.30248 36.979815 100.6373 C 36.391347 100.97212 35.924348 101.4386 35.579384 102.03722 C 35.23442 102.62568 35.062103 103.31599 35.062103 104.10737 C 35.062103 104.87847 35.22958 105.56342 35.564398 106.16203 C 35.909362 106.7505 36.365647 107.21214 36.933823 107.54696 C 37.512145 107.88178 38.146621 108.04874 38.836549 108.04874 C 39.465601 108.04874 39.993266 107.9274 40.419398 107.6839 C 40.855676 107.43025 41.200311 107.10549 41.453961 106.7098 C 41.717757 106.31411 41.910468 105.8879 42.03222 105.43133 L 42.03222 106.08555 C 42.03222 106.3392 42.042417 106.60813 42.062709 106.89222 C 42.083001 107.16616 42.103395 107.39966 42.123687 107.59243 L 42.154176 107.8813 L 43.737025 107.8813 L 43.737025 100.30244 L 42.03222 100.30244 L 42.03222 102.51367 C 41.996791 102.37153 41.956519 102.23312 41.91078 102.0982 C 41.70786 101.49958 41.368066 101.0229 40.891204 100.66779 C 40.414342 100.31268 39.769669 100.13501 38.957989 100.13501 z M 73.97704 100.13501 C 73.246528 100.13501 72.587334 100.30248 71.998866 100.6373 C 71.410398 100.97212 70.943399 101.4386 70.598435 102.03722 C 70.253471 102.62568 70.081154 103.31599 70.081154 104.10737 C 70.081154 104.87847 70.248631 105.56342 70.583449 106.16203 C 70.928413 106.7505 71.384698 107.21214 71.952874 107.54696 C 72.531196 107.88178 73.165672 108.04874 73.8556 108.04874 C 74.484652 108.04874 75.011801 107.9274 75.437933 107.6839 C 75.874211 107.43025 76.219362 107.10549 76.473012 106.7098 C 76.736808 106.31411 76.929519 105.8879 77.051271 105.43133 L 77.051271 106.08555 C 77.051271 106.3392 77.061468 106.60813 77.08176 106.89222 C 77.102052 107.16616 77.122446 107.39966 77.142738 107.59243 L 77.173227 107.8813 L 78.756076 107.8813 L 78.756076 100.30244 L 77.051271 100.30244 L 77.051271 102.51367 C 77.015842 102.37153 76.97557 102.23312 76.929831 102.0982 C 76.726911 101.49958 76.386601 101.0229 75.909739 100.66779 C 75.432877 100.31268 74.78872 100.13501 73.97704 100.13501 z M 83.717014 100.13501 C 83.260444 100.13501 82.83959 100.19083 82.454042 100.30244 C 82.068494 100.4039 81.73354 100.55098 81.449452 100.74376 C 81.165364 100.93653 80.942578 101.17487 80.780242 101.45896 C 80.628052 101.7329 80.551832 102.04262 80.551832 102.38758 C 80.551832 102.76299 80.632892 103.08239 80.795228 103.34618 C 80.96771 103.59983 81.20121 103.81294 81.495444 103.98542 C 81.789678 104.14775 82.119275 104.28464 82.484531 104.39625 C 82.849787 104.50785 83.220172 104.60931 83.595574 104.70062 C 83.96083 104.7615 84.265193 104.83288 84.508697 104.91404 C 84.752201 104.99521 84.934715 105.09667 85.056467 105.21842 C 85.188365 105.34017 85.254388 105.51249 85.254388 105.7357 C 85.254388 105.91833 85.208759 106.08045 85.117445 106.22249 C 85.036277 106.36454 84.889195 106.47619 84.676129 106.55735 C 84.473209 106.63852 84.18924 106.67931 83.823984 106.67931 C 83.255808 106.67931 82.804363 106.5623 82.469545 106.32894 C 82.134727 106.08544 81.926462 105.7714 81.845294 105.38585 L 80.277947 105.38585 C 80.257655 105.53804 80.272693 105.72539 80.323423 105.94861 C 80.384299 106.17182 80.490593 106.40532 80.642783 106.64882 C 80.794973 106.89233 81.008078 107.12047 81.28202 107.33353 C 81.566108 107.5466 81.9161 107.71943 82.332086 107.85133 C 82.758218 107.98323 83.260648 108.04874 83.83897 108.04874 C 84.49846 108.04874 85.061557 107.96284 85.528273 107.79035 C 85.994989 107.60773 86.350337 107.34899 86.593841 107.01417 C 86.847491 106.67936 86.974179 106.27838 86.974179 105.81166 C 86.974179 105.43626 86.89796 105.1217 86.74577 104.86805 C 86.59358 104.6144 86.385831 104.41149 86.122035 104.2593 C 85.868385 104.09697 85.57906 103.96492 85.254388 103.86346 C 84.929716 103.75186 84.584565 103.64556 84.219309 103.5441 C 83.823615 103.45279 83.478981 103.36153 83.184747 103.27022 C 82.890513 103.1789 82.661853 103.07209 82.499517 102.95034 C 82.347327 102.81844 82.271624 102.64612 82.271624 102.43306 C 82.271624 102.14897 82.393473 101.92567 82.636977 101.76333 C 82.880481 101.601 83.235312 101.51994 83.702028 101.51994 C 84.168744 101.51994 84.518735 101.61119 84.752093 101.79382 C 84.985451 101.97645 85.142731 102.27061 85.223899 102.67645 L 86.715281 102.67645 C 86.715281 102.1793 86.598789 101.73805 86.365431 101.3525 C 86.142219 100.96696 85.807265 100.66795 85.360841 100.45488 C 84.924563 100.24182 84.376504 100.13501 83.717014 100.13501 z M 57.997137 100.30244 L 57.997137 107.8813 L 59.701426 107.8813 L 59.701426 100.30244 L 57.997137 100.30244 z M 67.128362 100.30244 L 63.612815 103.63557 L 67.630657 107.8813 L 69.791766 107.8813 L 65.791493 103.67949 L 69.472405 100.30244 L 67.128362 100.30244 z M 39.35383 101.53544 C 39.922006 101.53544 40.404043 101.64173 40.799737 101.8548 C 41.195431 102.05772 41.499794 102.35188 41.71286 102.73743 C 41.925926 103.11283 42.03222 103.56964 42.03222 104.10737 C 42.03222 104.59438 41.925926 105.03027 41.71286 105.41582 C 41.50994 105.80137 41.205577 106.10573 40.799737 106.32894 C 40.404043 106.54201 39.922006 106.64882 39.35383 106.64882 C 38.856676 106.64882 38.415428 106.54201 38.02988 106.32894 C 37.644332 106.11588 37.33997 105.81687 37.116758 105.43133 C 36.903692 105.04578 36.79688 104.60453 36.79688 104.10737 C 36.79688 103.34642 37.020183 102.7275 37.466607 102.25064 C 37.913031 101.77378 38.54215 101.53544 39.35383 101.53544 z M 74.372881 101.53544 C 74.941057 101.53544 75.423094 101.64173 75.818788 101.8548 C 76.214482 102.05772 76.518845 102.35188 76.731911 102.73743 C 76.944977 103.11283 77.051271 103.56964 77.051271 104.10737 C 77.051271 104.59438 76.944977 105.03027 76.731911 105.41582 C 76.528991 105.80137 76.224628 106.10573 75.818788 106.32894 C 75.423094 106.54201 74.941057 106.64882 74.372881 106.64882 C 73.875727 106.64882 73.434479 106.54201 73.048931 106.32894 C 72.663383 106.11588 72.359021 105.81687 72.135809 105.43133 C 71.922743 105.04578 71.815932 104.60453 71.815932 104.10737 C 71.815932 103.34642 72.039234 102.7275 72.485658 102.25064 C 72.932082 101.77378 73.561201 101.53544 74.372881 101.53544 z "></path>
                </g>
              </g>
            </svg>
          </MastheadLogo>
        </MastheadBrand>
      </MastheadMain>
      <KebabDropdownWithIconsV6 />
    </Masthead>
  );

  const location = useLocation();

  const renderNavItem = (route: IAppRoute, index: number) => (
    <NavItem key={`${route.label}-${index}`} id={`${route.label}-${index}`} isActive={route.path === location.pathname}>
      <NavLink to={route.path}>{route.label}</NavLink>
    </NavItem>
  );

  const renderNavGroup = (group: IAppRouteGroup, groupIndex: number) => (
    <NavExpandable
      key={`${group.label}-${groupIndex}`}
      id={`${group.label}-${groupIndex}`}
      title={group.label}
      isActive={group.routes.some((route) => route.path === location.pathname)}
    >
      {group.routes.map((route, idx) => route.label && renderNavItem(route, idx))}
    </NavExpandable>
  );

  const Navigation = (
    <Nav id="nav-primary-simple">
      <NavList id="nav-list-simple">
        {routes.map(
          (route, idx) => route.label && (!route.routes ? renderNavItem(route, idx) : renderNavGroup(route, idx)),
        )}
      </NavList>
    </Nav>
  );

  const Sidebar = (
    <PageSidebar isSidebarOpen={sidebarOpen}>
      <PageSidebarBody>{Navigation}</PageSidebarBody>
    </PageSidebar>
  );

  const pageId = 'primary-app-container';

  const PageSkipToContent = (
    <SkipToContent
      onClick={(event) => {
        event.preventDefault();
        const primaryContentContainer = document.getElementById(pageId);
        primaryContentContainer?.focus();
      }}
      href={`#${pageId}`}
    >
      Skip to Content
    </SkipToContent>
  );
  return (
    <Page
      mainContainerId={pageId}
      masthead={masthead}
      sidebar={
        <PageSidebar>
          <PageSidebarBody>{Navigation}</PageSidebarBody>
        </PageSidebar>
      }
      skipToContent={PageSkipToContent}
      isManagedSidebar
    >
      {children}
    </Page>
  );
};

        <Masthead>
          <MastheadMain>
            <MastheadToggle>
              <PageToggleButton
                isSidebarOpen={sidebarOpen}
                onSidebarToggle={() => setSidebarOpen(!sidebarOpen)}
                aria-label="Global navigation"
              />
            </MastheadToggle>
            <MastheadBrand>{/* logo */}</MastheadBrand>
          </MastheadMain>
          <KebabDropdownWithIconsV6 />
        </Masthead>
